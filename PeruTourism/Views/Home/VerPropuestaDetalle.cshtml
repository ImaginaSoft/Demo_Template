@model PeruTourism.Models.PeruTourism.PropuestaViewModel
@using PeruTourism.Utility
@{
    /**/

    ViewBag.Title = "VerPropuestaDetalle";

    var lstProgramas = Model.lstPrograma;

    var lstServicios = Model.lstServicio;

    var lstPropuestaPrecio = Model.lstPropuestaPrecio;

    string nroPedido = string.Empty;
    string nroPropuesta = string.Empty;
    string nroVersion = string.Empty;
    bool flagMostrarBolitas = true;

    char idioma = ViewBag.FlagIdioma;

    if (lstProgramas != null)
    {
        foreach (var gg in lstProgramas)
        {

            if (gg.StsPrograma == "Vendido" || gg.StsPrograma == "Sold")
            {

                nroPedido = gg.KeyReg.Substring(0, 6);
                nroPropuesta = gg.KeyReg.Substring(8, 1);
                nroVersion = gg.KeyReg.Substring(10, 1);
                flagMostrarBolitas = true;
                break;
            }
            else
            {
                nroPedido = "0";
                nroPropuesta = "0";
                nroVersion = "0";
                flagMostrarBolitas = false;
            }



        }
    }

    var NombreCliente = ViewBag.NomCliente == null ? "" : ViewBag.NomCliente;
    var CodCliente = ViewBag.CodCliente == null ? "" : ViewBag.CodCliente;

    //var idioma = ViewBag.Idioma == null ? "E" : ViewBag.Idioma;

    var lajaxOptionsForm = new AjaxOptions()
    {
        HttpMethod = "POST",
        OnBegin = "e_ajax_iniciando",
        OnComplete = "e_ajax_finalizando_form_ficha",
        OnFailure = "e_ajax_error"
    };

    int SumPrice = 0;


    bool flagVendido = ViewBag.FlagVendido;
}

<style type="text/css">
    .prop-clear, .prop-clear:hover {
        background: #fafafa;
        box-shadow: none;
    }

        .prop-clear .prop-num::before {
            display: none;
        }

        .prop-clear .prop-title::before {
            display: none;
        }

        .prop-clear .prop-content .group {
            border: 0;
        }
</style>

<style>
    #btnMoveRight {
        border: none;
        margin-right: 10px;
    }
</style>

<style type="text/css">
    #CondicionesContainer .prop-detalle,
    #CondicionesContainer .prop-detalle:hover {
        background: #fafafa;
        box-shadow: none;
    }

        #CondicionesContainer .prop-detalle .prop-content {
            padding-top: 0px;
        }

        #CondicionesContainer .prop-detalle .prop-num::before {
            display: none;
        }

        #CondicionesContainer .prop-detalle .prop-title::before {
            display: none;
        }

        #CondicionesContainer .prop-detalle .prop-content .group {
            border: 0;
        }
</style>
@*<script type="text/javascript">

    $("a[href^='#']").click(function(e) {
        e.preventDefault();

        var position = $($(this).attr("href")).offset().top;

        $("body, html").animate({
            scrollTop: position
        } /* speed */ );
    });
    </script>*@
<script src="~/Scripts/Galeria/Galeria.js"></script>

@if (lstServicios.Count != 0)
{
    if (idioma.Equals(ConstantesWeb.CHR_IDIOMA_INGLES))
    {

        <div id="prop" class="secondary">
            <div class="container-fluid">
                <section class="slider" id="scenex" style="margin-bottom: 0px;">
                    <div class="container">
                        <span class="description">Here is where the trip of your lifetime starts...</span>

                        <div class="options">
                            <div class="op-group">
                                @*<span class="description">Details</span>*@
                                @*<section class="subtitle" style="margin-bottom: 0px;">
                                        <div class="container">
                                            <div class="options">
                                                <div class="op-group">
                                                    <div class="op op-propuesta">
                                                        <div class="icon icon-propuesta"></div>

                                                        @if (flagVendido == true)
                                                        {
                                                            <div class="title">My booked trip</div>
                                                        }
                                                        else
                                                        {

                                                            <div class="title">My travel itineraries</div>
                                                        }

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>*@
                            </div>
                        </div>
                    </div>
                    <img src="~/Content/images/slider-prop.jpg" class="img-bg" data-depth="0.1">

                </section>
                <div class="breadcrumb">
                    <a href="@Url.Action("Login", "Home",new { id = Session["IdCliente"] })">
                        <span class="breadcrumb__inner">
                            <span class="breadcrumb__desc">Home</span>
                        </span>
                    </a>

                    @if (flagVendido == true)
                    {
                        <a href="@Url.Action("VerPropuesta", "Home",new { pCodCliente = ViewBag.codCliente , pFlagVendido = flagVendido})">
                            <span class="breadcrumb__inner">
                                <span class="breadcrumb__desc">My booked trip</span>
                            </span>
                        </a>
                        <input id="mostrarMenuVendido" value="ok" style="display:none" />
                        @*<div id="mostrarMenuVendido" style="display:none">ok</div>*@
                    }
                    else
                    {
                        <a href="@Url.Action("VerPropuesta", "Home",new { pCodCliente = ViewBag.codCliente , pFlagVendido = false})">
                            <span class="breadcrumb__inner">
                                <span class="breadcrumb__desc">My travel itineraries</span>
                            </span>
                        </a>

                    }


                    <div class="no_enlace">
                        <span class="breadcrumb__inner">
                            <span class="breadcrumb__title">Details</span>
                        </span>
                    </div>
                </div>


            </div>
            <!-- contenido -->
            <div class="container">
                <section class="group prop-group">

                    <a href="#section1">

                        <div class="group prop">
                            <div class="prop-num"><span>@lstProgramas.FirstOrDefault().NroPrograma</span></div>
                            <div class="prop-title">@Html.Raw(lstProgramas.FirstOrDefault().DesPrograma)</div>
                            <div class="prop-status"><span class="status status-new">@lstProgramas.FirstOrDefault().StsPrograma</span></div>
                        </div>
                    </a>




                    @if (flagMostrarBolitas == true)
                    {
                        <div class="container">

                            <section class="options-interna">
                                <div class="op-group">
                                    <div class="op op-info">
                                        <a onclick="openBookingStatusModal(@nroPedido, @nroPropuesta, @nroVersion,'I')">
                                            <div class="icon icon-booking"></div>
                                            <div class="description">
                                                Booking<br />status
                                            </div>
                                        </a>
                                    </div>
                                    <div class="op op-info">
                                        <a onclick="openBalanceModal(@CodCliente, @nroPedido,'I')">
                                            <div class="icon icon-balance"></div>
                                            <div class="description">My Balance<br />due</div>
                                        </a>
                                    </div>
                                    <div class="op op-info">
                                        <a onclick="openInformationBeforeTripModal(@nroPedido, @nroPropuesta, @nroVersion,'I')">
                                            <div class="icon icon-info"></div>
                                            <div class="description">Useful information<br />for my trip</div>
                                        </a>
                                    </div>
                                </div>
                            </section>

                            <div class="optionsMini op-group text-center">
                                <a class="agregarPass btn btn-primary btnSeleccion" href="@Url.Action("Pasajero", "Home",new { pIdPedido = nroPedido, pIdioma=idioma })">
                                    Add Traveler Information
                                </a>
                            </div>
                        </div>


                    }


                    @for (int i = 0; i < lstServicios.Count; i++)
                    {
                        string[] servicios = lstServicios[i].DesServicioDet.Split('|');

                        if (lstServicios[i].NroDia.ToString() == "1")
                        {

                            <div class="group prop-detalle">
                                <div class="group group-collapse collapsed" id="section1" data-toggle="collapse" data-target="#content_@lstServicios[i].NroDia.ToString()">
                                    <div class="prop-num"><span>Día @lstServicios[i].NroDia.ToString()</span></div>
                                    <div class="prop-title">@Html.Raw(lstServicios[i].DesServicio)</div>
                                </div>
                                <div class="prop-content collapse in" id="content_@lstServicios[i].NroDia.ToString()">
                                    <div class="group">
                                        <div class="prop-info">
                                            <div class="info"><i class="icon icon-location"></i>  @lstServicios[i].Ciudad.ToString()</div>

                                            @*@if (lstServicios[i].HoraServicio.ToString().Trim() != string.Empty)
                                                {
                                                    <div class="info"><i class="icon icon-time"></i> @lstServicios[i].HoraServicio.ToString()</div>
                                                }*@



                                            <div class="info"><i class="icon icon-calendar"></i> @lstServicios[i].FchInicio.ToString("dd/MM/yyyy")</div>
                                        </div>
                                        <ul>
                                            @foreach (string servicio in servicios)
                                            {



                                                if (servicio != string.Empty)
                                                {

                                                    var posicionBuscado = servicio.IndexOf("↕");
                                                    var tamañoCadena = servicio.Length;

                                                    var starIndex = posicionBuscado + 1;
                                                    var endIndex = tamañoCadena - starIndex;
                                                    var servicioEncontrado = string.Empty;

                                                    if (posicionBuscado != -1)
                                                    {
                                                        servicioEncontrado = servicio.Substring(starIndex, endIndex);
                                                    }



                                                    if (servicioEncontrado != string.Empty)
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio.Substring(0, posicionBuscado))

                                                        </li>

                                                        <div class="fare-detail" data-toggle="modal"><a href="javascript:void(0);" class="shorttexthref"><span onclick="openDetailHotel(@servicioEncontrado)"><i class="icon icon-hotel-detalle"></i>Hotel details</span></a></div>

                                                    }
                                                    else
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio)
                                                        </li>

                                                    }





                                                }



                                            }
                                        </ul>
                                    </div>
                                </div>
                                <div class="prop-icon"></div>
                            </div>

                        }
                        else
                        {
                            <div class="group prop-detalle">
                                <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content_@lstServicios[i].NroDia.ToString()">
                                    <div class="prop-num"><span>Día @lstServicios[i].NroDia.ToString()</span></div>
                                    <div class="prop-title">@Html.Raw(lstServicios[i].DesServicio)</div>
                                </div>
                                <div class="prop-content collapse" id="content_@lstServicios[i].NroDia.ToString()">
                                    <div class="group">
                                        <div class="prop-info">
                                            <div class="info"><i class="icon icon-location"></i>  @lstServicios[i].Ciudad.ToString()</div>

                                            @*@if (lstServicios[i].HoraServicio.ToString().Trim() != string.Empty)
                                                {
                                                    <div class="info"><i class="icon icon-time"></i> @lstServicios[i].HoraServicio.ToString()</div>
                                                }*@



                                            <div class="info"><i class="icon icon-calendar"></i> @lstServicios[i].FchInicio.ToString("dd/MM/yyyy")</div>
                                        </div>
                                        <ul>
                                            @foreach (string servicio in servicios)
                                            {



                                                if (servicio != string.Empty)
                                                {

                                                    var posicionBuscado = servicio.IndexOf("↕");
                                                    var tamañoCadena = servicio.Length;

                                                    var starIndex = posicionBuscado + 1;
                                                    var endIndex = tamañoCadena - starIndex;
                                                    var servicioEncontrado = string.Empty;

                                                    if (posicionBuscado != -1)
                                                    {
                                                        servicioEncontrado = servicio.Substring(starIndex, endIndex);
                                                    }



                                                    if (servicioEncontrado != string.Empty)
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio.Substring(0, posicionBuscado))

                                                        </li>

                                                        <div class="fare-detail" data-toggle="modal"><a href="javascript:void(0);" class="shorttexthref"><span onclick="openDetailHotel(@servicioEncontrado)"><i class="icon icon-hotel-detalle"></i>Hotel details</span></a></div>

                                                    }
                                                    else
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio)
                                                        </li>

                                                    }





                                                }



                                            }
                                        </ul>
                                    </div>
                                </div>
                                <div class="prop-icon"></div>
                            </div>

                        }


                    }
                </section>

                <div class="group prop-detalle">
                    <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content_25">
                        <div class="prop-num-especiales"><span>SPECIAL FEATURES</span></div>
                        <div class="prop-title"></div>
                    </div>
                    <div class="prop-content collapse in" id="content_25">
                        <div class="group">
                            @Html.Raw(lstServicios.FirstOrDefault().Resumen)
                            @Html.Raw(lstServicios.FirstOrDefault().ResuCaraEspe)

                        </div>
                    </div>
                </div>

                <div class="prop-table">
                    <div class="col-sm-12">
                        <div>
                            <div class="col-sm-12" id="titulo">
                                <h3 style="text-align:center"><strong>PRICE:</strong></h3>
                            </div>
                            <div class="col-sm-11" id="tituloIMG">
                                <img src="~/Content/images/FlechaDerecha.gif" id="btnMoveRight" style="width: 50px;" />
                            </div>
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table id="demoGrid" class="table table-striped table-bordered dt-responsive nowrap table-pt" width="100%"
                                           cellspacing="0">
                                        <thead>

                                            <tr>
                                                <th>DESCRIPTION</th>
                                                <th>PRICE PER PERSON</th>
                                                <th>NUMBER OF TRAVELLERS</th>
                                                <th>TOTAL PRICE</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var d in lstPropuestaPrecio)
                                            {

                                                SumPrice = SumPrice + Convert.ToInt32(d.PrecioTotal);


                                                <tr>
                                                    <td>@d.DesOrden</td>
                                                    <td>USD @Convert.ToDecimal(d.PrecioxPersona).ToString("#,##0")</td>
                                                    <td>@d.CantPersonas</td>
                                                    <td>USD @Convert.ToDecimal(d.PrecioTotal).ToString("#,##0")</td>
                                                </tr>


                                            }

                                            <tr class="table-total hidden-xs">
                                                <td colspan="3">Total</td>
                                                <td>USD @Convert.ToDecimal(SumPrice).ToString("#,##0")</td>
                                            </tr>
                                        </tbody>
                                        @{int totalSumPrice = SumPrice; }
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="div-total visible-xs">
                            Total: @Convert.ToDecimal(totalSumPrice).ToString("#,##0")
                        </div>
                    </div>

                    <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                        <div class="col-sm-6" style="padding-top: 15px; padding-bottom: 10px">
                            <a href="javascript:void(0);" class="pago" data-toggle="modal" data-target="#condicionPago">
                                <span onclick="">
                                    <i class="icon icon-hotel-detalle"></i> PAYMENT
                                    PROCEDURE
                                </span>
                            </a>
                        </div>
                        <div class="col-sm-6">
                            <a class="pago btn btn-primary" href="@Url.Action("Pago", "Home",new { pIdPedido = lstProgramas.FirstOrDefault().KeyReg, pCodCliente = ViewBag.codCliente, pNroPrograma = ViewBag.NroPrograma, pFlagIdioma = ViewBag.FlagIdioma, pFlagVendido = flagVendido})">
                                PAY NOW
                            </a>
                        </div>

                    </div>

                    <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                        <div class="col-sm-6">

                        </div>
                        <div class="col-sm-6">
                            <img src="~/Content/images/logos.jpg" width="100%" />
                        </div>
                    </div>
                </div>

                @*<div class="prop-table">

                        <div class="table-responsive">

                            <table id="tablaCostos" role="table">
                                <thead role="rowgroup">
                                    <tr role="row">
                                        <th role="columnheader">DESCRIPTION</th>
                                        <th role="columnheader">PRICE PER PERSON</th>
                                        <th role="columnheader">NUMBER OF TRAVELLERS</th>
                                        <th role="columnheader">TOTAL PRICE</th>

                                    </tr>
                                </thead>
                                <tbody role="rowgroup">
                                    @foreach (var d in lstPropuestaPrecio)
                                    {

                                        SumPrice = SumPrice + Convert.ToInt32(d.PrecioTotal);


                                        <tr>
                                            <td>@d.DesOrden</td>
                                            <td>USD @Convert.ToDecimal(d.PrecioxPersona).ToString("#,##0")</td>
                                            <td>@d.CantPersonas</td>
                                            <td>USD @Convert.ToDecimal(d.PrecioTotal).ToString("#,##0")</td>
                                        </tr>


                                    }

                                </tbody>

                            </table>
                            <div class="div-total hidden-xs">
                                Total Price: @Convert.ToDecimal(SumPrice).ToString("#,##0")
                            </div>
                            <div class="div-total visible-xs">
                                Total Price: @Convert.ToDecimal(SumPrice).ToString("#,##0")
                            </div>

                        </div>

                        <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                            <div class="col-sm-6" style="padding-top: 15px; padding-bottom: 10px">
                                <a href="javascript:void(0);" class="pago" data-toggle="modal" data-target="#condicionPago">
                                    <span onclick="">
                                        <i class="icon icon-hotel-detalle"></i> PAYMENT
                                        PROCEDURE
                                    </span>
                                </a>
                            </div>
                            <div class="col-sm-6">
                                <a class="pago btn btn-primary" href="@Url.Action("Pago", "PagoVisa",new { pIdPedido = lstProgramas.FirstOrDefault().KeyReg, pCodCliente = ViewBag.codCliente, pNroPrograma = ViewBag.NroPrograma, pFlagIdioma = ViewBag.FlagIdioma, pFlagVendido = flagVendido})">
                                    PAY NOW
                                </a>
                            </div>

                        </div>

                        <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                            <div class="col-sm-6">

                            </div>
                            <div class="col-sm-6">
                                <img src="~/Content/images/logos.jpg" width="100%" />
                            </div>
                        </div>
                    </div>*@

            </div>

            <div id='detailsContainer'>
                @Html.Partial("~/Views/Galeria/_ModalDetalleHotel.cshtml")
            </div>

            <div id='balanceContainer'>
                @Html.Partial("~/Views/Home/_ModalMostrarSaldo.cshtml")
            </div>
            <div id='BookingStatusContainer'>
                @Html.Partial("~/Views/Home/_ModalBookingStatus.cshtml")
            </div>

            <div id='InforBeforeTripContainer'>
                @Html.Partial("~/Views/Home/_ModalInfoBeforeTrip.cshtml")
            </div>
            @*<div id='CondicionesContainer_GG'>
                    @Html.Partial("~/Views/Visa/_ModalCondicionesPago.cshtml")
                </div>*@

            <div id="CondicionesContainer">
                <div class="modal fade" id="condicionPago" tabindex="-1" role="dialog">
                    <div class="modal-dialog modal-DetalleHotel" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <strong>PAYMENT PROCEDURE</strong>
                                <button class="close" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                            </div>
                            <div class="modal-body">


                                <div class="group prop-detalle">
                                    <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content1">
                                        <div class="prop-num"><span>Payment Procedure</span></div>

                                    </div>
                                    <div class="prop-content collapse in" id="content1">
                                        <div class="group">


                                            <p>
                                                To confirm confirm your trip we just need a deposit of the 30%, this first payment can be done online through your personalized website only if you hava a Visa Card or Master Card
                                                , if you have American Express card I will send you our services agreement by email.
                                                <br />
                                                * The balance due will be paid one week before your arrival in Peru.
                                            </p>


                                        </div>
                                    </div>
                                    <div class="prop-icon"></div>
                                </div>

                                <div class="group prop-detalle">
                                    <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content1">
                                        <div class="prop-num"><span>Our Cancellation Policy</span></div>

                                    </div>
                                    <div class="prop-content collapse in" id="content1">
                                        <div class="group">


                                            <p>
                                                Fully acquit you of all cost(*) that may be generated by the cancellation of the services already booked by PeruTourism according to the itinerary
                                                in case you cancel the services up yo 45 days before you arrival.

                                                <br />
                                                (*) Valid only for parties not larger than six (06) people.<br />
                                                (*) Valid for every destination throughout Peru.<br />
                                                (*) The Inca Trail is not included in this Cancelation policy.<br />
                                                (*) The Amazon cruises are not included in this Cancelation policy.<br />
                                                (*) Valid for cancellations 45 days before your arrival.<br />
                                                (*) The domestic or international air tickets are not included in this Cancelation Policy.<br />
                                                (*) The amount to be refunded will have a charge of $50 per passenger.
                                                <strong>Our cancellations after this term:</strong><br />
                                                The penalty will be 50% of the tour. Customer will accept credit card debiting or other payment method.
                                                <strong>Our Cancellation Policy after the arrival::</strong><br />
                                                If the customer cancels part or all services after the beginning of the Tour, it will be charged with not less than 100% of agreed total price of Tour.
                                                <br />
                                            </p>

                                        </div>
                                    </div>
                                    <div class="prop-icon"></div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <div class="floating-chat enter expand">
            @*<i class="cerrarFlotante" aria-hidden="true" style="display: none; font-style: normal; font-size: 15px">Chat</i>*@
            <i class="fa fa-comments" aria-hidden="true"></i>
            <div class="chat enter">
                <div class="header">
                    <span class="title">
                        Send us your message
                    </span>
                    <button>
                        <i class="fa fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <input type="text" id="txtCodCliente" value="@ViewBag.codCliente" hidden />
                <input type="text" id="txtNroPedido" value="@ViewBag.nroPedido" hidden />
                <input type="text" id="txtNroPropuesta" value="@ViewBag.nroPropuesta" hidden />
                <input type="text" id="txtNroVersion" value="@ViewBag.nroVersion" hidden />

                <div style="font-size:13px; text-align:justify;">Hi I'm @Session["NombreVendedor"] your Travel Designer.From now on, I will immediately answer all your questions. </div>
                <div id="mensajeConfirmacion" class="form-label" hidden style="font-weight: bold;">Your message have been sent</div>
                <div id="mensajeConfirmacionGG" class="form-label" hidden style="font-weight: bold;">Please enter your message</div>
                <textarea placeholder="Write your messages here" id="txtMessage" class="form-control"></textarea>
                <button type="submit" class="pago btn btn-primary" id="btnSend">SEND</button>
            </div>
        </div>


    }
    else
    {

        <div id="prop" class="secondary">
            <div class="container-fluid">
                @*<section class="subtitle" style="margin-bottom: 0px;">
                        <div class="container">
                            <div class="options">
                                <div class="op-group">
                                    <div class="op op-propuesta">
                                            <div class="icon icon-propuesta"></div>

                                            @if (flagVendido == true)
                                            {
                                                <div class="title">Mi viaje reservado</div>
                                            }
                                            else
                                            {
                                                <div class="title">Propuestas para mi viaje</div>
                                            }



                                        </div>
                                </div>
                            </div>
                        </div>
                    </section>*@

                <section class="slider" id="scenex" style="margin-bottom: 0px;">
                    <div class="container">
                        <span class="description">Aquí es donde comienza el viaje de tu vida...</span>

                        <div class="options">
                            <div class="op-group">
                                @*<span class="description">Details</span>*@
                                @*<section class="subtitle" style="margin-bottom: 0px;">
                                        <div class="container">
                                            <div class="options">
                                                <div class="op-group">
                                                    <div class="op op-propuesta">
                                                        <div class="icon icon-propuesta"></div>

                                                        @if (flagVendido == true)
                                                        {
                                                            <div class="title">My booked trip</div>
                                                        }
                                                        else
                                                        {

                                                            <div class="title">My travel itineraries</div>
                                                        }

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>*@
                            </div>
                        </div>
                    </div>
                    <img src="~/Content/images/slider-prop.jpg" class="img-bg" data-depth="0.1">

                </section>

                <div class="breadcrumb">
                    <a href="@Url.Action("Login", "Home",new { id = Session["IdCliente"] })">
                        <span class="breadcrumb__inner">
                            <span class="breadcrumb__desc">Inicio</span>
                        </span>
                    </a>

                    @if (flagVendido == true)
                    {
                        <a href="@Url.Action("VerPropuesta", "Home",new { pCodCliente = ViewBag.codCliente,pFlagVendido=flagVendido })">
                            <span class="breadcrumb__inner">
                                <span class="breadcrumb__desc">Mi viaje reservado</span>
                            </span>
                        </a>

                        <input id="mostrarMenuVendido" value="ok" style="display:none" />
                        @*<div id="mostrarMenuVendido" style="display:none">ok</div>*@
                    }
                    else
                    {

                        <a href="@Url.Action("VerPropuesta", "Home",new { pCodCliente = ViewBag.codCliente,pFlagVendido=false })">
                            <span class="breadcrumb__inner">
                                <span class="breadcrumb__desc">Propuestas para mi viaje</span>
                            </span>
                        </a>
                    }



                    <div class="no_enlace">
                        <span class="breadcrumb__inner">
                            <span class="breadcrumb__title">Detalle</span>
                        </span>
                    </div>
                </div>



            </div>
            <!-- contenido -->
            <div class="container">
                <section class="group prop-group">

                    <a href="#section1">

                        <div class="group prop">
                            <div class="prop-num"><span>@lstProgramas.FirstOrDefault().NroPrograma</span></div>
                            <div class="prop-title">@Html.Raw(lstProgramas.FirstOrDefault().DesPrograma)</div>
                            <div class="prop-status"><span class="status status-new">@lstProgramas.FirstOrDefault().StsPrograma</span></div>
                        </div>
                    </a>



                    @if (flagMostrarBolitas == true)
                    {
                        <div class="container">

                            <section class="options-interna">
                                <div class="op-group">
                                    <div class="op op-info">
                                        <a onclick="openBookingStatusModal(@nroPedido, @nroPropuesta, @nroVersion,'E')">
                                            <div class="icon icon-booking"></div>
                                            <div class="description">
                                                Estado de<br />mi reserva
                                            </div>
                                        </a>
                                    </div>
                                    <div class="op op-info">
                                        <a onclick="openBalanceModal(@CodCliente, @nroPedido,'E')">
                                            <div class="icon icon-balance"></div>
                                            <div class="description">Cuenta<br />Corriente</div>
                                        </a>
                                    </div>
                                    <div class="op op-info">
                                        <a onclick="openInformationBeforeTripModal(@nroPedido, @nroPropuesta, @nroVersion,'E')">
                                            <div class="icon icon-info"></div>
                                            <div class="description">Información<br />para mi viaje</div>
                                        </a>
                                    </div>
                                </div>
                            </section>

                            <div class="optionsMini op-group text-center">
                                <a class="agregarPass btn btn-primary btnSeleccion" href="@Url.Action("Pasajero", "Home",new {  pIdPedido = nroPedido, pIdioma=idioma })">
                                    Agregar información del pasajero
                                </a>
                            </div>

                            @*<div class="optionsMini op-group text-center">
                                    <a class="agregarPass btn btn-primary btnSeleccion" href="@Url.Action("Pasajero", "Home",new { pIdPedido = nroPedido, pIdioma=idioma })">
                                        Add Traveler Information
                                    </a>
                                </div>*@
                            @*<div class="col-sm-5">
                                    <a class="pago btn btn-primary btnSeleccion" href="@Url.Action("Pasajero", "Home",new {  pIdPedido = nroPedido, pIdioma=idioma })">
                                        Agregar pasajero
                                    </a>
                                </div>*@


                        </div>
                    }


                    @for (int i = 0; i < lstServicios.Count; i++)
                    {
                        string[] servicios = lstServicios[i].DesServicioDet.Split('|');

                        if (lstServicios[i].NroDia.ToString() == "1")
                        {

                            <div class="group prop-detalle">
                                <div class="group group-collapse collapsed" id="section1" data-toggle="collapse" data-target="#content_@lstServicios[i].NroDia.ToString()">
                                    <div class="prop-num"><span>Día @lstServicios[i].NroDia.ToString()</span></div>
                                    <div class="prop-title">@Html.Raw(lstServicios[i].DesServicio)</div>
                                </div>
                                <div class="prop-content collapse in" id="content_@lstServicios[i].NroDia.ToString()">
                                    <div class="group">
                                        <div class="prop-info">
                                            <div class="info"><i class="icon icon-location"></i>  @lstServicios[i].Ciudad.ToString()</div>

                                            @*@if (lstServicios[i].HoraServicio.ToString().Trim() != string.Empty)
                                                {
                                                    <div class="info"><i class="icon icon-time"></i> @lstServicios[i].HoraServicio.ToString()</div>
                                                }*@



                                            <div class="info"><i class="icon icon-calendar"></i> @lstServicios[i].FchInicio.ToString("dd/MM/yyyy")</div>
                                        </div>
                                        <ul>
                                            @foreach (string servicio in servicios)
                                            {



                                                if (servicio != string.Empty)
                                                {

                                                    var posicionBuscado = servicio.IndexOf("↕");
                                                    var tamañoCadena = servicio.Length;

                                                    var starIndex = posicionBuscado + 1;
                                                    var endIndex = tamañoCadena - starIndex;
                                                    var servicioEncontrado = string.Empty;

                                                    if (posicionBuscado != -1)
                                                    {
                                                        servicioEncontrado = servicio.Substring(starIndex, endIndex);
                                                    }



                                                    if (servicioEncontrado != string.Empty)
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio.Substring(0, posicionBuscado))

                                                        </li>

                                                        <div class="fare-detail" data-toggle="modal"><a href="javascript:void(0);" class="shorttexthref"><span onclick="openDetailHotel(@servicioEncontrado)"><i class="icon icon-hotel-detalle"></i>Detalle Hotel</span></a></div>

                                                    }
                                                    else
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio)
                                                        </li>

                                                    }





                                                }



                                            }
                                        </ul>
                                    </div>
                                </div>
                                <div class="prop-icon"></div>
                            </div>
                        }
                        else
                        {

                            <div class="group prop-detalle">
                                <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content_@lstServicios[i].NroDia.ToString()">
                                    <div class="prop-num"><span>Día @lstServicios[i].NroDia.ToString()</span></div>
                                    <div class="prop-title">@Html.Raw(lstServicios[i].DesServicio)</div>
                                </div>
                                <div class="prop-content collapse" id="content_@lstServicios[i].NroDia.ToString()">
                                    <div class="group">
                                        <div class="prop-info">
                                            <div class="info"><i class="icon icon-location"></i>  @lstServicios[i].Ciudad.ToString()</div>

                                            @*@if (lstServicios[i].HoraServicio.ToString().Trim() != string.Empty)
                                                {
                                                    <div class="info"><i class="icon icon-time"></i> @lstServicios[i].HoraServicio.ToString()</div>
                                                }*@



                                            <div class="info"><i class="icon icon-calendar"></i> @lstServicios[i].FchInicio.ToString("dd/MM/yyyy")</div>
                                        </div>
                                        <ul>
                                            @foreach (string servicio in servicios)
                                            {



                                                if (servicio != string.Empty)
                                                {

                                                    var posicionBuscado = servicio.IndexOf("↕");
                                                    var tamañoCadena = servicio.Length;

                                                    var starIndex = posicionBuscado + 1;
                                                    var endIndex = tamañoCadena - starIndex;
                                                    var servicioEncontrado = string.Empty;

                                                    if (posicionBuscado != -1)
                                                    {
                                                        servicioEncontrado = servicio.Substring(starIndex, endIndex);
                                                    }



                                                    if (servicioEncontrado != string.Empty)
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio.Substring(0, posicionBuscado))

                                                        </li>

                                                        <div class="fare-detail" data-toggle="modal"><a href="javascript:void(0);" class="shorttexthref"><span onclick="openDetailHotel(@servicioEncontrado)"><i class="icon icon-hotel-detalle"></i>Detalle Hotel</span></a></div>

                                                    }
                                                    else
                                                    {

                                                        <li>
                                                            @Html.Raw(servicio)
                                                        </li>

                                                    }





                                                }



                                            }
                                        </ul>
                                    </div>
                                </div>
                                <div class="prop-icon"></div>
                            </div>

                        }

                    }
                </section>
                <div class="group prop-detalle">
                    <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content_25">
                        <div class="prop-num-especiales"><span>CARACTERÍSTICAS ESPECIALES</span></div>
                        <div class="prop-title"></div>
                    </div>
                    <div class="prop-content collapse in" id="content_25">
                        <div class="group">
                            @*<h2>This program includes :</h2>*@
                            @Html.Raw(lstServicios.FirstOrDefault().Resumen)
                            @Html.Raw(lstServicios.FirstOrDefault().ResuCaraEspe)

                        </div>
                    </div>
                </div>
                <div class="prop-table">
                    <div class="col-sm-12">
                        <div>
                            <!--<div class="col-sm-1">
                                <img src="~/Repository/FlechaDerecha.gif" id="btnMoveRight" style="width: 50px; margin-top:30px;" />
                            </div>-->


                            <div class="col-sm-12" id="titulo">
                                <h3 style="text-align:center"><strong>PRECIO:</strong></h3>
                            </div>
                            <div class="col-sm-11" id="tituloIMG">
                                <img src="~/Content/images/FlechaDerecha.gif" id="btnMoveRight" style="width: 50px;" />
                            </div>
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table id="demoGrid" class="table table-striped table-bordered dt-responsive nowrap table-pt" width="100%"
                                           cellspacing="0">
                                        <thead>

                                            <tr>
                                                <th>DESCRIPCIÓN</th>
                                                <th>POR PERSONA</th>
                                                <th>NUMERO DE VIAJEROS</th>
                                                <th>TOTAL</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var d in lstPropuestaPrecio)
                                            {

                                                SumPrice = SumPrice + Convert.ToInt32(d.PrecioTotal);


                                                <tr>
                                                    <td>@d.DesOrden</td>
                                                    <td>USD @Convert.ToDecimal(d.PrecioxPersona).ToString("#,##0")</td>
                                                    <td>@d.CantPersonas</td>
                                                    <td>USD @Convert.ToDecimal(d.PrecioTotal).ToString("#,##0")</td>
                                                </tr>


                                            }

                                            <tr class="table-total hidden-xs">
                                                <td colspan="3">Total</td>
                                                <td>USD @Convert.ToDecimal(SumPrice).ToString("#,##0")</td>
                                            </tr>
                                        </tbody>
                                        @{int totalSumPrice = SumPrice; }
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="div-total visible-xs">
                            Total: @Convert.ToDecimal(totalSumPrice).ToString("#,##0")
                        </div>
                    </div>

                    <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                        <div class="col-sm-6" style="padding-top: 15px; padding-bottom: 10px">
                            <a href="javascript:void(0);" class="pago" data-toggle="modal" data-target="#condicionPago">
                                <span onclick="">
                                    <i class="icon icon-hotel-detalle"></i> PROCEDIMIENTO
                                    DE PAGO
                                </span>
                            </a>
                        </div>
                        <div class="col-sm-6">
                            <a class="pago btn btn-primary" href="@Url.Action("Pago", "Home",new { pIdPedido = lstProgramas.FirstOrDefault().KeyReg, pCodCliente = ViewBag.codCliente, pNroPrograma = ViewBag.NroPrograma, pFlagIdioma = ViewBag.FlagIdioma, pFlagVendido = flagVendido})">
                                PAGA AHORA
                            </a>
                        </div>

                    </div>

                    <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                        <div class="col-sm-6">

                        </div>
                        <div class="col-sm-6">
                            <img src="~/Content/images/logos.jpg" width="100%" />
                        </div>
                    </div>
                </div>

                @*<div class="prop-table">
                        <div class="table-responsive">

                            <table role="table">
                                <thead role="rowgroup">
                                    <tr role="row">
                                        <th role="columnheader">DESCRIPCIÓN</th>
                                        <th role="columnheader">PRECIO POR PERSONA</th>
                                        <th role="columnheader">NUMERO DE PASAJEROS</th>
                                        <th role="columnheader">PRECIO</th>

                                    </tr>
                                </thead>
                                <tbody role="rowgroup">
                                    @foreach (var d in lstPropuestaPrecio)
                                    {

                                        SumPrice = SumPrice + Convert.ToInt32(d.PrecioTotal);


                                        <tr>
                                            <td>@d.DesOrden</td>
                                            <td>USD @Convert.ToDecimal(d.PrecioxPersona).ToString("#,##0")</td>
                                            <td>@d.CantPersonas</td>
                                            <td>USD @Convert.ToDecimal(d.PrecioTotal).ToString("#,##0")</td>
                                        </tr>


                                    }

                                </tbody>
                            </table>
                            <div class="div-total hidden-xs">
                                Precio total: @Convert.ToDecimal(SumPrice).ToString("#,##0")
                            </div>
                            <div class="div-total visible-xs">
                                Precio total: @Convert.ToDecimal(SumPrice).ToString("#,##0")
                            </div>
                        </div>

                        <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                            <div class="col-sm-6" style="padding-top: 15px; padding-bottom: 10px">
                                <a href="javascript:void(0);" class="pago" data-toggle="modal" data-target="#condicionPago">
                                    <span onclick="">
                                        <i class="icon icon-hotel-detalle"></i> PAYMENT
                                        PROCEDURE
                                    </span>
                                </a>
                            </div>
                            <div class="col-sm-6">
                                <a class="pago btn btn-primary" href="@Url.Action("Pago", "PagoVisa",new { pIdPedido = lstProgramas.FirstOrDefault().KeyReg, pCodCliente = ViewBag.codCliente, pNroPrograma = ViewBag.NroPrograma, pFlagIdioma = ViewBag.FlagIdioma, pFlagVendido = flagVendido})">
                                    PAY NOW
                                </a>
                            </div>

                        </div>

                        <div class=" col-sm-8 col-sm-offset-2 text-center fare-detail">
                            <div class="col-sm-6">

                            </div>
                            <div class="col-sm-6">
                                <img src="~/Content/images/logos.jpg" width="100%" />
                            </div>
                        </div>
                    </div>*@

            </div>

            <div id='detailsContainer'>
                @Html.Partial("~/Views/Galeria/_ModalDetalleHotel.cshtml")
            </div>

            <div id='balanceContainer'>
                @Html.Partial("~/Views/Home/_ModalMostrarSaldo.cshtml")
            </div>
            <div id='BookingStatusContainer'>
                @Html.Partial("~/Views/Home/_ModalBookingStatus.cshtml")
            </div>

            <div id='InforBeforeTripContainer'>
                @Html.Partial("~/Views/Home/_ModalInfoBeforeTrip.cshtml")
            </div>
            @*<div id='CondicionesContainer_GG'>
                    @Html.Partial("~/Views/Visa/_ModalCondicionesPago.cshtml")
                </div>*@

            <div id="CondicionesContainer">
                <div class="modal fade" id="condicionPago" tabindex="-1" role="dialog">
                    <div class="modal-dialog modal-DetalleHotel" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <strong>PROCEDIMIENTO DE PAGO</strong>
                                <button class="close" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                            </div>
                            <div class="modal-body">


                                <div class="group prop-detalle">
                                    <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content1">
                                        <div class="prop-num"><span>Forma de Pago</span></div>

                                    </div>
                                    <div class="prop-content collapse in" id="content1">
                                        <div class="group">


                                            <p>
                                                Para confirmar tu viaje únicamente necesitamos un depósito del 30% del costo total.
                                                <br />
                                                * El saldo pendiente será pagado una semana antes de su llegada a Perú.
                                            </p>


                                        </div>
                                    </div>
                                    <div class="prop-icon"></div>
                                </div>

                                <div class="group prop-detalle">
                                    <div class="group group-collapse collapsed" data-toggle="collapse" data-target="#content1">
                                        <div class="prop-num"><span>Política de cancelación</span></div>

                                    </div>
                                    <div class="prop-content collapse in" id="content1">
                                        <div class="group">


                                            <p>
                                                Está liberado por completo de cualquier penalidad (*) que pueda generarse por la cancelación de los
                                                servicios contratados con PeruTourism en el caso que usted cancele los servicios ya reservados hasta 45 días antes de su llegada.
                                                <br />
                                                (*) Válido sólo para grupos no mayores de seis (06) personas.<br />
                                                (*) Válido para todos los destinos en Perú.<br />
                                                (*) El Camino Inca a Machu Picchu no está incluido en esta política.<br />
                                                (*) Los cruceros en el Amazonas no están incluidos en esta política.<br />
                                                (*) Válido para las cancelaciones 45 días antes de su llegada.<br />
                                                (*) Los boletos aéreos nacionales o Internacional no están incluidos en esta política de cancelación.<br />
                                                (*) El importe a reembolsar tendrá un cargo de 50 dólares por pasajero.<br />
                                                <strong>Para las cancelaciones después de este plazo:</strong><br />
                                                La penalidad será del 50% del valor de tour para lo cual acepto el débito mi tarjeta de Crédito u otro medio de pago previa coordinación con PeruTurismo.
                                                <strong>Una vez iniciado su viaje al Perú:</strong><br />
                                                La penalidad por la anulación por parte del cliente una vez iniciado el viaje a Perú será del 100% del precio total pactado.
                                                En caso se presentaran situaciones ajenas a nuestro control PERUTURISMO no se hará responsable de los gastos adicionales en que se incurran, pero sí les brindará la asistencia necesaria para resolver el problema.

                                            </p>

                                        </div>
                                    </div>
                                    <div class="prop-icon"></div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="floating-chat enter expand">
            <i class="fa fa-comments" aria-hidden="true"></i>
            <div class="chat enter">
                <div class="header">
                    <span class="title">
                        Envianos tu mensaje
                    </span>
                    <button>
                        <i class="fa fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <input type="text" id="txtCodCliente" value="@ViewBag.codCliente" hidden />
                <input type="text" id="txtNroPedido" value="@ViewBag.nroPedido" hidden />
                <input type="text" id="txtNroPropuesta" value="@ViewBag.nroPropuesta" hidden />
                <input type="text" id="txtNroVersion" value="@ViewBag.nroVersion" hidden />

                <div style="font-size:13px; text-align:justify;">Hola soy @Session["NombreVendedor"], tu Diseñadora de Viajes. A partir de ahora, por este medio atenderé de inmediato todas tus consultas.</div>
                <div id="mensajeConfirmacion" class="form-label" hidden style="font-weight: bold;">Tu mensaje ha sido enviado</div>
                <div id="mensajeConfirmacionGG" class="form-label" hidden style="font-weight: bold;">Por favor ingresa tu mensaje</div>
                <textarea placeholder="Por favor escribe tu mensaje" id="txtMessage" class="form-control"></textarea>
                <button type="submit" class="pago btn btn-primary" id="btnSend">ENVIAR</button>
            </div>
        </div>

    }

}
else
{
    <div>No hay servicios por mostrar</div>
}

<script src="~/Scripts/Galeria/Galeria.js"></script>
<script src="~/Scripts/Envio/EnvioMensaje.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        var flagGG = $('#mostrarMenuVendido').val();

        if (flagGG != null) {
            $(".marcaMenu").removeClass("active");
            $(".marcaMenu03").addClass("active");
        } else {
            $(".marcaMenu").removeClass("active");
            $(".marcaMenu02").addClass("active");
        }

        // Botón mover a la derecha
        $('#btnMoveRight').click(() => {
            $('.table-responsive').scrollLeft($('#demoGrid').width() - $('.table-responsive').width())
        })

    });
</script>